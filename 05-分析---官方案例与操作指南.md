# Palantir Foundry 分析 - 官方案例与操作指南

> 更新时间：2025-12-28

## 目录

- [官方教程资源](#官方教程资源)
- [模块架构概述](#模块架构概述)
- [Contour - 表格数据分析](#contour---表格数据分析)
- [Quiver - 对象和时间序列分析](#quiver---对象和时间序列分析)
- [Fusion - 类 Excel 电子表格](#fusion---类-excel-电子表格)
- [Notepad - 文档和报告](#notepad---文档和报告)
- [最佳实践](#最佳实践)
- [故障排除](#故障排除)

---

## 官方教程资源

### Palantir Learn 课程

| 课程名称 | 时长 | 描述 | 链接 |
|---------|------|------|------|
| Deep Dive: Data Analysis in Contour | 45-60 分钟 | Contour 深入数据分析课程 | [查看](https://learn.palantir.com/data-analysis-in-contour) |
| Introduction to Quiver | 30-45 分钟 | Quiver 对象和时间序列分析入门 | [查看](https://learn.palantir.com/intro-to-quiver) |
| Data Analysis in Contour | 60-90 分钟 | 高级 Contour 分析技术 | [查看](https://learn.palantir.com/data-analysis-in-contour) |
| Training Track - Data Analyst | 4-6 小时 | 数据分析师完整培训路径 | [查看](https://learn.palantir.com/page/training-track-data-analyst) |

### 视频教程

| 视频名称 | 平台 | 链接 |
|---------|------|------|
| Palantir Foundry: Contour 101 | YouTube | [观看](https://www.youtube.com/watch?v=3yzenPa5jOQ) |
| Deep Dive: Data Analysis in Contour | YouTube | [观看](https://www.youtube.com/watch?v=wnMOY0Ezo6o) |
| Deep Dive: Data Analysis in Quiver | YouTube | [观看](https://www.youtube.com/watch?v=FGLlWLxfH-c) |
| Quiver | How to Build an Analysis | YouTube | [观看](https://www.youtube.com/watch?v=GUP99JByHxQ) |
| Intro to Notepad | YouTube | [观看](https://www.youtube.com/watch?v=ElEtTvrBSxA) |

---

## 模块架构概述

### 组件关系图

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      分析模块 (Module 05)                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐              │
│  │   Contour    │    │    Quiver    │    │    Fusion    │              │
│  │  表格数据     │    │  对象/时序    │    │  电子表格    │              │
│  └──────────────┘    └──────────────┘    └──────────────┘              │
│         │                    │                     │                    │
│         ▼                    ▼                     ▼                    │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐              │
│  │   Notepad    │◀──▶│   Dashboards │◀──▶│   Reports    │              │
│  │  文档报告     │    │   仪表板      │    │   输出        │              │
│  └──────────────┘    └──────────────┘    └──────────────┘              │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│  核心功能：                                                               │
│  • 点按式数据分析  • 交互式可视化  • 实时仪表板  • 文档报告生成            │
└─────────────────────────────────────────────────────────────────────────┘
```

### 应用对比

| 应用 | 数据类型 | 主要用途 | 用户群体 |
|------|---------|---------|---------|
| **Contour** | 表格数据集 | 大规模数据分析和可视化 | 数据分析师 |
| **Quiver** | Ontology 对象、时间序列 | 对象关系和时序分析 | 业务分析师 |
| **Fusion** | 数据集、电子表格 | 类 Excel 的数据操作 | 财务/业务用户 |
| **Notepad** | 多媒体内容 | 报告和文档生成 | 所有用户 |

---

## Contour - 表格数据分析

### 核心概念

Contour 是 Foundry 的点按式分析工具，用于分析大规模表格数据并创建交互式仪表板。从原始数据电子表格到揭示数据洞察的图表。

### 访问 Contour

1. 选择数据集
2. 点击 "Analyze" 按钮
3. Contour 自动打开并加载数据

### 官方案例：纽约人口分析

#### 数据集介绍

本教程使用来自 2010 年美国人口普查的纽约市社区数据：

| 列名 | 类型 | 描述 |
|------|------|------|
| Borough | 字符串 | 纽约市五个区之一 |
| Population | 数字 | 社区人口数量 |
| NTA_Name | 字符串 | 社区名称 |
| FIPS_County_Code | 字符串 | 县代码 |

### 创建图表

#### 步骤 1：创建基础柱状图

**目标**：可视化每个行政区的人口

1. 添加数据集到 Contour
2. 创建柱状图：
   - **X 轴**: Borough
   - **Y 轴**: Sum of Population

![基础柱状图](https://www.palantir.com/docs/resources/foundry/contour/getting-started-chart-tutorial-pt-1.png)

#### 步骤 2：排序图表

**配置**：在 Options 中选择 **Y axis descending** 排序

![排序后的图表](https://www.palantir.com/docs/resources/foundry/contour/getting-started-chart-tutorial-pt-2.png)

### 添加叠加层

#### 目标

添加平均社区人口作为折线叠加层，以了解各区的人口密度。

**步骤**：
1. 点击 **+ Add overlay**
2. 选择折线图
3. 在新轴上绘制

![叠加层图表](https://www.palantir.com/docs/resources/foundry/contour/getting-started-chart-tutorial-pt-3.png)

**洞察**：虽然曼哈顿总人口排名第三，但每个社区的平均人口约为 55,000 人，高于其他任何区。

### 格式化图表

#### 修改标题和标签

在 **Format** 标签页：

| 设置 | 原值 | 新值 |
|------|------|------|
| 左 Y 轴标题 | Sum of Population | Population |
| 右 Y 轴标题 | Mean of Population | Mean of Population per Neighborhood |
| 图例 | 开启 | 关闭 |

![格式化图表](https://www.palantir.com/docs/resources/foundry/contour/getting-started-chart-tutorial-pt-4.png)

#### 修改颜色

点击绿色方块选择自定义颜色，或使线条变为虚线。

![颜色选择](https://www.palantir.com/docs/resources/foundry/contour/getting-started-chart-tutorial-pt-5.png)

#### 显示单位

在 **Number Format Options** 中：
- **Display Unit**: Millions
- **小数位数**: 2

![显示单位](https://www.palantir.com/docs/resources/foundry/contour/getting-started-chart-display-units.png)

### 数据分段

**目标**：查看构成每个行政区人口的具体社区

**操作**：在 **Main Chart** 标签页中，将 Neighborhood 添加为分段

![分段图表](https://www.palantir.com/docs/resources/foundry/contour/getting-started-chart-tutorial-pt-6.png)

### 高级技巧

#### 自定义系列排序

1. 在 **Format** 标签页
2. 点击 **Format Series**
3. 选择排序方式：
   - 升序/降序
   - 基于另一列的自定义排序
   - 使用拖动手动排序

![自定义系列排序](https://www.palantir.com/docs/resources/foundry/contour/getting-started-custom-series-sort.png)

#### 折线图系列排序

控制折线图中点的绘制顺序：

| day | temperature | wind_speed |
|-----|-------------|------------|
| 1   | 50          | 0          |
| 2   | 36          | 10         |
| 3   | 70          | 25         |

**目标**：按时间顺序绘制温度与风速的关系图

**解决方案**：在 **Series Sort Options** 中添加 `day`

![折线图系列排序](https://www.palantir.com/docs/resources/foundry/contour/getting-started-line-chart-with-series-sort.png)

### Contour 分析路径

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      Contour 分析路径                                     │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐              │
│  │ 输入数据 │───▶│  数据板 │───▶│  图表   │───▶│ 仪表板 │              │
│  └─────────┘    └─────────┘    └─────────┘    └─────────┘              │
│                     │              │                                  │
│                     ▼              ▼                                  │
│              ┌─────────────────────────────┐                          │
│              │      分析操作               │                          │
│              │  • 过滤    • 分组    • 聚合  │                          │
│              │  • 连接    • 计算    • 排序  │                          │
│              └─────────────────────────────┘                          │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## Quiver - 对象和时间序列分析

### 核心概念

Quiver 提供点按式界面，用于分析来自 Ontology 的对象和时间序列数据。

### 创建 Quiver 分析

1. 展开 Foundry 侧边栏
2. 在 Applications 部分选择 **View all**
3. 在 **Analytics & Operations** 部分找到 Quiver
4. 选择 **+New Analysis**
5. 选择文件夹并保存

![创建 Quiver 分析](https://www.palantir.com/docs/resources/foundry/quiver/getting-started-create-quiver-analysis.png)

### 官方案例：NYC Buildings 分析

#### 添加对象数据

**步骤**：
1. 选择 **+Add data to analysis**
2. 搜索对象类型（如 "NYC Buildings"）
3. 添加到分析中

![添加对象数据](https://www.palantir.com/docs/resources/foundry/quiver/getting-started-adding-objects.gif)

**结果**：对象集卡片显示：
- 对象表格预览
- 对象总数（右上角）

#### 过滤对象

**目标**：筛选 2010-2020 年建造的建筑和车库

**操作**：
1. 悬停在对象集卡片上
2. 选择 **Filter > Filter object set**
3. 配置过滤条件：
   - Year Constructed: 2010-2020
   - Building Type: building 或 garage

![过滤对象](https://www.palantir.com/docs/resources/foundry/quiver/getting-started-filter-objects.gif)

#### 构建图表

**目标**：按建筑类型显示平均屋顶高度

**操作**：
1. 悬停在过滤对象集卡片上
2. 选择 **Visualize > Bar chart**
3. 配置：
   - **Group by**: Building Type
   - **Metric**: Average Roof Height
   - **Segment by**: Year Constructed
4. 格式化：
   - **Orientation**: Vertical
   - **Segmentation**: Grouped

![创建图表](https://www.palantir.com/docs/resources/foundry/quiver/getting-started-create-chart.gif)

**洞察**：2010-2020 年间，建筑的平均屋顶高度稳步增加，而车库的平均屋顶高度缓慢下降。

### 添加时间序列数据

**目标**：添加纽瓦克机场温度时间序列

**操作**：
1. 在分析顶部栏选择 **Time Series**
2. 搜索 "Weather stations" 对象类型中的 "newark"
3. 添加 Newark Liberty International 机场的 Temperature 时间序列属性
4. 关闭搜索栏
5. 在时间序列图上拖动选择时间范围
6. 选择 **Zoom to selection**

![添加时间序列](https://www.palantir.com/docs/resources/foundry/quiver/getting-started-adding-time-series.gif)

### 导出时间序列

**目标**：计算 30 天滚动平均温度

**操作**：
1. 悬停在时间序列图上
2. 选择 **Add plot**
3. 选择 **Rolling aggregate** 转换
4. 配置：30 天滚动窗口

![导出时间序列](https://www.palantir.com/docs/resources/foundry/quiver/getting-started-build-time-series.gif)

### 格式化时间序列

**操作**：
1. 在编辑器面板的 **Display** 标签页
2. 配置：
   - 线宽：加粗
   - 渐变填充：开启
   - 颜色：紫色
3. 拖动图例项将导出图移至新图表

![格式化时间序列](https://www.palantir.com/docs/resources/foundry/quiver/getting-started-display-time-series.gif)

### Quiver 分析模式

#### Canvas 模式 vs Graph 模式

| 模式 | 特点 | 适用场景 |
|------|------|---------|
| **Canvas** | 自由布局，拖拽卡片 | 探索性分析 |
| **Graph** | 结构化连接视图 | 理解对象关系 |

### 卡片类型索引

| 卡片类型 | 功能 |
|---------|------|
| **Objects** | 对象集卡片、过滤对象集 |
| **Time Series** | 时间序列图表、转换 |
| **Charts** | 柱状图、折线图、散点图 |
| **Tables** | 表格预览、转换表格 |
| **Search** | 时间序列搜索异常 |

---

## Fusion - 类 Excel 电子表格

### 核心概念

Fusion 是 Foundry 的电子表格应用程序，提供类似 Excel 的用户体验。

### 主要功能

| 功能 | 描述 |
|------|------|
| **查询数据集** | 通过搜索和数据查找查询 Foundry 数据集 |
| **单元格引用** | 使用单元格引用和电子表格函数 |
| **交互式电子表格** | 使用下拉菜单和链接单元格 |
| **写回数据集** | 提交结果并写回数据集到 Foundry |

### Fusion 表格概览

Fusion 电子表格外观和行为与其他电子表格应用程序类似：

| 特性 | 支持 |
|------|------|
| 在任何位置输入内容 | ✅ |
| 单元格引用 (A1, B2) | ✅ |
| 电子表格函数 | ✅ |
| 公式库 | ✅ |
| 数组公式 | ✅ |

### 公式库

Fusion 的函数库结合了 Contour 和其他 Foundry 应用的函数：

| 类别 | 示例函数 |
|------|---------|
| **Foundry 数据集查询** | SEARCH, LOOKUP |
| **聚合函数** | SUM, AVERAGE, COUNT |
| **文本函数** | CONCATENATE, SUBSTRING |
| **日期函数** | DATE_DIFF, DATE_TO_STRING |
| **逻辑函数** | IF, AND, OR |
| **时间序列函数** | TIME_SERIES, ROLLING_AGGREGATE |

### 创建和使用表区域

**表区域**是 Fusion 中的核心概念，用于：

- 定义数据范围
- 应用格式设置
- 创建数据验证规则

**创建步骤**：
1. 选择单元格范围
2. 右键选择 **Create table region**
3. 配置表属性

### 下拉菜单、锁定单元格和链接

| 功能 | 配置方法 |
|------|---------|
| **下拉菜单** | 数据验证 > 列表 |
| **锁定单元格** | 格式化 > 锁定 |
| **单元格链接** | =单元格引用 |
| **超链接** | 插入 > 链接 |

### 数据集同步

#### 同步表到数据集

**步骤**：
1. 准备 Fusion 表格
2. 选择 **Sync to dataset**
3. 配置目标数据集
4. 设置同步选项

#### 重新同步表

当源数据变更时：
1. 打开 Fusion 表格
2. 选择 **Resync table**
3. 查看变更预览
4. 确认重新同步

### 数据更新和编辑历史

Fusion 自动跟踪：
- 单元格修改历史
- 数据集更新时间戳
- 用户编辑记录

### 演示视图

**Presentation View** 用于：
- 隐藏公式和编辑工具
- 仅显示格式化结果
- 适合演示和分享

---

## Notepad - 文档和报告

### 核心概念

Notepad 是 Foundry 的报告工具，可创建实时更新和静态（"时间点"）文档。

### 主要功能

| 功能 | 描述 |
|------|------|
| **富文本编辑** | 对象感知的协作式富文本编辑器 |
| **小部件嵌入** | 集成图表、表格、地图等 |
| **模板系统** | 创建可重用的文档模板 |
| **PDF 导出** | 导出为 PDF 格式 |
| **实时更新** | 数据自动更新 |

### 创建 Notepad 文档

**步骤**：
1. 打开 Notepad 应用
2. 选择 **+ New Document**
3. 选择文件夹
4. 输入文档标题
5. 开始编辑

### 添加内容

#### 文本和格式

| 功能 | 操作 |
|------|------|
| **标题** | # 一级标题, ## 二级标题 |
| **粗体** | **粗体文本** |
| **斜体** | *斜体文本* |
| **列表** | - 项目列表 |
| **代码** | `代码` 或 ```代码块``` |

#### 嵌入小部件

支持的小部件类型：

| 小部件 | 描述 |
|--------|------|
| **Contour chart** | Contour 图表 |
| **Quiver chart** | Quiver 图表 |
| **Quiver dashboard** | Quiver 仪表板 |
| **Vertex graph** | Vertex 关系图 |
| **Map** | 地图可视化 |
| **Object card** | 对象卡片 |
| **Object property** | 对象属性 |
| **Table** | 表格 |
| **Image** | 图片 |
| **Functions** | 函数结果 |

### 模板系统

#### 创建模板

1. 设计 Notepad 文档
2. 添加模板输入
3. 将输入连接到小部件
4. 发布模板

#### 模板输入类型

| 输入类型 | 用途 |
|---------|------|
| **文本输入** | 标题、段落 |
| **对象选择器** | 选择特定对象 |
| **日期范围** | 时间筛选 |
| **参数** | 动态配置 |

### 与 Workshop 集成

| 功能 | 描述 |
|------|------|
| **显示链接文档** | 显示与对象关联的文档 |
| **嵌入文档** | 在 Workshop 中嵌入 Notepad |
| **生成和导出** | 从 Workshop 生成文档 |

### 导出为 PDF

**步骤**：
1. 打开 Notepad 文档
2. 选择 **Export > PDF**
3. 配置导出选项
4. 下载 PDF 文件

---

## 最佳实践

### Contour 最佳实践

| 实践 | 说明 |
|------|------|
| **使用数据板** | 先理解数据分布，再创建图表 |
| **参数化分析** | 使用参数使分析可重用 |
| **保存为数据集** | 将分析结果保存为新数据集 |
| **优化性能** | 对大数据集使用聚合数据 |

### Quiver 最佳实践

| 实践 | 说明 |
|------|------|
| **从对象开始** | 从对象类型开始分析，逐步深入 |
| **使用过滤器** | 逐步过滤以缩小范围 |
| **时间序列可视化** | 使用适当的时间序列图表类型 |
| **创建仪表板** | 分享分析结果给团队 |

### Fusion 最佳实践

| 实践 | 说明 |
|------|------|
| **使用表区域** | 定义清晰的数据区域 |
| **验证公式** | 使用公式验证确保数据正确 |
| **锁定关键单元格** | 防止意外修改 |
| **文档化表格** | 添加注释说明复杂逻辑 |

### Notepad 最佳实践

| 实践 | 说明 |
|------|------|
| **使用模板** | 标准化报告格式 |
| **锁定小部件数据** | 保持一致性 |
| **版本历史** | 跟踪文档变更 |
| **协作编辑** | 利用实时协作功能 |

---

## 故障排除

### Contour 常见问题

| 问题 | 解决方案 |
|------|---------|
| **图表不显示** | 检查数据路径配置，确保数据板已连接 |
| **性能缓慢** | 切换到聚合数据模式 |
| **计算错误** | 检查表达式语法和列引用 |
| **导出失败** | 验证数据集权限 |

### Quiver 常见问题

| 问题 | 解决方案 |
|------|---------|
| **对象不显示** | 检查对象类型权限和 Ontology 配置 |
| **时间序列缺失** | 验证时间序列属性配置 |
| **图表无法交互** | 检查浏览器兼容性 |
| **仪表板加载慢** | 减少同时显示的卡片数量 |

### Fusion 常见问题

| 问题 | 解决方案 |
|------|---------|
| **公式错误** | 检查函数语法和参数 |
| **同步失败** | 验证数据集结构和列类型 |
| **查找慢** | 使用索引优化查找性能 |
| **格式丢失** | 检查表区域配置 |

### Notepad 常见问题

| 问题 | 解决方案 |
|------|---------|
| **小部件不更新** | 刷新页面或检查数据源连接 |
| **导出 PDF 失败** | 检查文档大小和小部件数量 |
| **模板不工作** | 验证模板输入配置 |
| **协作冲突** | 使用版本历史解决冲突 |

---

## 相关文档

- [Contour 官方文档](https://palantir.com/docs/foundry/contour/overview/)
- [Quiver 官方文档](https://palantir.com/docs/foundry/quiver/overview/)
- [Fusion 官方文档](https://palantir.com/docs/foundry/fusion/overview/)
- [Notepad 官方文档](https://palantir.com/docs/foundry/notepad/overview/)
- [数据连接与集成指南](01-数据连接与集成---官方案例与操作指南.md)
- [本体构建指南](03-本体构建---官方案例与操作指南.md)
- [用例开发指南](04-用例开发---官方案例与操作指南.md)

---

*本文档基于 Palantir Foundry 官方文档整理*
