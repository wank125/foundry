# AIP Logic 概览

> 更新时间：2025-12-28
> 文档来源：https://palantir.com/docs/foundry/logic/overview/

## 概述

**AIP Logic** 是一个**无代码开发环境**，用于构建、测试和发布由 **LLM（大语言模型）驱动的函数**。AIP Logic 使您能够构建利用 Ontology 的功能丰富的 AI 驱动函数，而无需开发环境和 API 调用通常带来的复杂性。

## 核心价值

通过 AIP Logic 的直观界面，应用构建者可以：

- **工程化提示**：设计和优化 LLM 提示
- **测试和评估**：全面测试和评估 Logic 函数
- **监控**：监控 Logic 函数性能
- **设置自动化**：配置自动化工作流

## 主要功能

### 1. 无代码开发

- **直观界面**：无需编码即可构建 AI 函数
- **拖放操作**：可视化构建 Logic 流程
- **模块化组件**：使用预构建组件

### 2. LLM 集成

- **LLM 块**：使用 LLM 处理数据
- **提示工程**：工程化和优化提示
- **上下文管理**：管理 LLM 上下文

### 3. Ontology 集成

- **对象查询**：查询 Ontology 对象
- **数据访问**：访问对象属性
- **写入 Ontology**：将结果写回 Ontology

### 4. 自动化

- **自动编辑**：自动应用 Ontology 编辑
- **人工审核**：暂存编辑供人工审核
- **触发器**：基于事件触发 Logic 函数

## 工作原理

### Logic 函数结构

```
┌─────────────────────────────────────────────────────────────┐
│              AIP Logic 函数结构                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  输入 (Inputs)                                              │
│  ├── Ontology 对象                                         │
│  ├── 文本字符串                                            │
│  └── 参数                                                  │
│     ↓                                                        │
│  Logic 块 (Logic Blocks)                                    │
│  ├── LLM 处理块                                            │
│  ├── 数据查询块                                            │
│  ├── 数据转换块                                            │
│  └── 条件逻辑块                                            │
│     ↓                                                        │
│  输出 (Outputs)                                             │
│  ├── 对象                                                  │
│  ├── 字符串                                                │
│  └── Ontology 编辑                                         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 示例：供应链助手

```
┌─────────────────────────────────────────────────────────────┐
│           供应链邮件分析示例                                │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  输入: 客户邮件内容                                         │
│     ↓                                                        │
│  LLM 块:                                                   │
│  "你是我的供应链助手。查找描述类似事  │
│   件的其他邮件。仅查看邮件正文。      │
│   根据过去有效的解决方案确定最       │
│   佳解决方案。返回你的一个解决       │
│   方案建议。"                                               │
│     ↓                                                        │
│  数据查询: 查询历史邮件对象                                 │
│     ↓                                                        │
│  输出: 推荐解决方案                                         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 使用场景

### 1. 供应链优化

- **冲突解决**：解决调度冲突
- **资产优化**：优化资产性能
- **中断响应**：响应供应链中断

### 2. 客户服务

- **邮件分析**：分析客户邮件
- **解决方案推荐**：推荐解决方案
- **历史匹配**：匹配历史案例

### 3. 数据处理

- **非结构化数据**：连接非结构化输入到 Ontology
- **数据提取**：从文本提取结构化数据
- **数据分类**：自动分类数据

### 4. 决策支持

- **智能推荐**：基于历史推荐
- **风险评估**：评估风险
- **资源分配**：优化资源分配

## 核心概念

### 1. Logic 函数

**Logic 函数**是包含以下内容的可重用单元：
- 输入参数
- Logic 块序列
- 输出配置
- 权限设置

### 2. Logic 块

**Logic 块**是构建 Logic 函数的基本组件：

| 块类型 | 功能 |
|--------|------|
| **Use LLM** | 使用 LLM 处理文本 |
| **Query objects** | 查询 Ontology 对象 |
| **Transform data** | 转换数据格式 |
| **Conditional logic** | 条件分支 |
| **Loop** | 循环处理 |

### 3. 变量

**变量**用于在块之间传递数据：
- **原始变量**：字符串、数字等
- **对象变量**：Ontology 对象
- **对象集变量**：对象集合

## 安全和权限

### 安全模型

AIP Logic 建立在与管理 Palantir 平台其余部分相同的严格安全模型之上，包括：

- **用户权限**：继承用户权限
- **函数权限**：控制函数访问
- **数据访问**：基于用户数据访问权限

### 最小权限原则

平台安全控制仅授予 LLM 完成任务所需的访问权限：
- **限制数据访问**：仅访问必要数据
- **限制操作**：仅允许必要操作
- **审计日志**：完整审计跟踪

## 开发工作流程

```
┌─────────────────────────────────────────────────────────────┐
│            AIP Logic 开发工作流程                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 创建 Logic 函数                                         │
│     ├── 定义输入参数                                       │
│     ├── 选择 LLM 模型                                      │
│     └── 配置权限                                           │
│     ↓                                                        │
│  2. 构建 Logic 流程                                         │
│     ├── 添加 LLM 块                                        │
│     ├── 配置提示词                                         │
│     ├── 添加数据查询                                       │
│     └── 配置输出                                           │
│     ↓                                                        │
│  3. 测试和调试                                              │
│     ├── 使用测试数据                                       │
│     ├── 检查中间结果                                       │
│     └── 优化提示词                                         │
│     ↓                                                        │
│  4. 评估和监控                                              │
│     ├── 评估函数性能                                       │
│     ├── 监控使用情况                                       │
│     └── 收集反馈                                           │
│     ↓                                                        │
│  5. 自动化和部署                                            │
│     ├── 配置自动化触发                                     │
│     ├── 设置人工审核                                       │
│     └── 部署到生产                                         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 工具和能力

### 1. Query objects 工具

- **对象查询**：查询 Ontology 对象
- **过滤**：基于条件过滤对象
- **聚合**：聚合对象数据

### 2. Use LLM 块

- **提示工程**：设计和优化提示
- **模型选择**：选择不同的 LLM 模型
- **参数配置**：配置温度、最大令牌等

### 3. 数据转换

- **格式转换**：转换数据格式
- **数据提取**：从文本提取数据
- **数据验证**：验证数据完整性

## 最佳实践

### 1. 提示工程

- **清晰指令**：提供清晰明确的指令
- **上下文信息**：提供充分的上下文
- **示例驱动**：使用示例引导模型
- **迭代优化**：持续优化提示

### 2. 性能优化

- **限制上下文**：限制 LLM 上下文大小
- **缓存结果**：缓存常用查询
- **批量处理**：批量处理请求

### 3. 错误处理

- **验证输入**：验证输入数据
- **处理失败**：优雅处理失败情况
- **重试机制**：实现重试机制

### 4. 安全

- **最小权限**：使用最小权限原则
- **数据脱敏**：脱敏敏感数据
- **审计日志**：维护审计日志

## 自动化

### 触发方式

- **对象变更**：基于对象变更触发
- **时间计划**：基于时间计划触发
- **手动执行**：手动执行 Logic 函数

### 执行模式

- **自动应用**：自动应用 Ontology 编辑
- **人工审核**：暂存编辑供人工审核
- **混合模式**：结合自动和人工审核

## 监控和评估

### 性能指标

- **执行时间**：函数执行时间
- **Token 使用**：Token 消耗
- **成功率**：函数成功率

### 质量指标

- **输出质量**：评估输出质量
- **用户满意度**：用户反馈
- **错误率**：错误率统计

## 与其他功能集成

### Functions

- **与 Functions 集成**：在 Functions 中调用 Logic
- **参数传递**：传递参数到 Logic
- **结果返回**：接收 Logic 结果

### Automate

- **自动化触发**：通过 Automate 触发 Logic
- **工作流集成**：集成到工作流
- **条件执行**：基于条件执行

### Workshop

- **用户界面**：在 Workshop 中调用 Logic
- **参数配置**：配置输入参数
- **结果显示**：显示 Logic 结果

## 限制

### 当前限制

- **LLM 依赖**：依赖 LLM 可用性
- **Token 限制**：受 Token 限制
- **响应时间**：响应时间可能变化

## 相关文档

- [Core concepts](https://palantir.com/docs/foundry/logic/core-concepts/) - 核心概念
- [Getting started](https://palantir.com/docs/foundry/logic/getting-started/) - 入门指南
- [Logic blocks](https://palantir.com/docs/foundry/logic/logic-blocks/) - Logic 块详解
- [Automation](https://palantir.com/docs/foundry/logic/automation/) - 自动化配置

---

*本文档基于 Palantir Foundry 官方文档整理*
