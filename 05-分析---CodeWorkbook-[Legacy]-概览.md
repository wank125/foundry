# Code Workbook [Legacy] 概览

> 更新时间：2025-12-28
> 文档来源：https://palantir.com/docs/foundry/code-workbook/overview/

## 概述

**Code Workbook [Legacy]** 是一个允许用户使用代码分析和转换数据的应用程序，通过直观的图形界面进行操作。

**重要提示**：Code Workbook 处于开发的遗留阶段，不再进行额外开发。完全支持仍然可用。我们建议探索其他应用程序和工具来满足您的用例需求。

## 核心价值

### 设计原则

Code Workbook 的设计遵循以下原则：

| 原则 | 说明 |
|------|------|
| **迭代速度** | 用户可以快速测试和优化转换和可视化逻辑，以产生有用结果 |
| **低门槛** | 图形界面和重用预编写逻辑的能力使不同技术水平的用户都能轻松上手 |
| **协作** | 不同的用户组可以在单个分析中共享逻辑并协同工作 |
| **平台互操作性** | 用户可以通过将可视化添加到 Notepad、将生产就绪管道提升到 Code Repositories 等方式在平台上实现其发现 |

## 主要功能

### 核心特性

```
┌─────────────────────────────────────────────────────────────┐
│              Code Workbook 核心特性                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  交互式控制台                                                │
│  ├── 快速迭代转换逻辑                                       │
│  ├── 临时数据探索                                           │
│  └── 代码调试                                               │
│                                                             │
│  可视化支持                                                  │
│  ├── Matplotlib                                             │
│  ├── Plotly                                                 │
│  ├── Seaborn                                                │
│  └── 其他常用包                                             │
│                                                             │
│  模板                                                        │
│  ├── 复用复杂逻辑                                           │
│  ├── 特定领域模板                                           │
│  └── 简单接口                                               │
│                                                             │
│  多语言支持                                                  │
│  ├── Python                                                 │
│  ├── PySpark                                                │
│  ├── R                                                      │
│  └── SQL                                                    │
│                                                             │
│  分支                                                        │
│  ├── 隔离用户变更                                           │
│  ├── 促进协作                                               │
│  └── 代码合并                                               │
│                                                             │
│  图形界面                                                    │
│  ├── 点选用户界面                                           │
│  ├── 自定义 Spark 环境                                      │
│  ├── 设置转换输入类型                                       │
│  └── 查看节点关系                                           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 支持的语言

### Python

- **用途**：数据转换、机器学习、可视化
- **库**：支持常见 Python 库
- **Spark**：PySpark 支持

### PySpark

- **用途**：大数据处理
- **性能**：分布式计算
- **集成**：与 Foundry Spark 集成

### SparkR

- **用途**：R 语言大数据处理
- **API**：R Filesystem API
- **性能**：分布式计算

### SQL

- **用途**：数据查询
- **语法**：Spark SQL 参考
- **功能**：数据转换

## 核心概念

### 1. Workbooks（工作簿）

**定义**：Code Workbook 中的分析单元。

**功能**：
- 组织代码节点
- 管理输入输出
- 版本控制

### 2. Transforms（转换）

**定义**：数据处理节点。

**功能**：
- 数据转换
- 数据可视化
- 访问非结构化文件

### 3. 模板（Templates）

**定义**：可重用的代码模板。

**功能**：
- 多节点模板
- 建议模板
- 自定义模板

### 4. 环境（Environment）

**定义**：代码执行环境。

**功能**：
- Code Workbook 配置文件
- 批处理和交互式构建
- 环境创建

### 5. 分支（Branching）

**定义**：代码版本管理。

**功能**：
- 合并分支
- 选择导入数据集分支
- 隔离变更

## 工作流程

### 典型工作流

```
┌─────────────────────────────────────────────────────────────┐
│           Code Workbook 工作流程                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 创建 Workbook                                           │
│     ├── 选择语言                                            │
│     ├── 配置环境                                            │
│     └── 添加输入数据集                                      │
│     ↓                                                        │
│  2. 添加转换节点                                            │
│     ├── 编写转换逻辑                                        │
│     ├── 可视化数据                                          │
│     └── 调试代码                                            │
│     ↓                                                        │
│  3. 使用模板                                                │
│     ├── 选择模板                                            │
│     ├── 配置参数                                            │
│     └── 运行模板                                            │
│     ↓                                                        │
│  4. 分支和协作                                              │
│     ├── 创建分支                                            │
│     ├── 合并变更                                            │
│     └── 代码审查                                            │
│     ↓                                                        │
│  5. 生产化                                                  │
│     ├── 导出到 Code Repository                             │
│     ├── 添加可视化到 Notepad                                │
│     └── 发布应用                                            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 输入和输出

### 输入

- **数据集**：Foundry 数据集
- **项目引用**：Code Repository 项目
- **参数**：分析参数

### 输出

- **数据集**：转换后的数据集
- **可视化**：图表和图形
- **代码**：可重用代码

## 控制台

### 功能

- **交互式执行**：快速执行代码片段
- **变量检查**：检查变量值
- **调试**：调试代码
- **日志**：查看执行日志

## 全局代码

### 功能

- **共享代码**：在所有节点间共享
- **导入库**：全局导入库
- **辅助函数**：定义辅助函数

## 数据持久化

### 可选持久化

- **持久化选项**：可选数据持久化
- **性能优化**：提高性能
- **存储管理**：管理存储使用

## 与 Code Repositories 比较

| 特性 | Code Workbook | Code Repositories |
|------|--------------|-------------------|
| **用户界面** | 图形界面 | 代码为主 |
| **迭代速度** | 快速迭代 | 较慢 |
| **生产就绪** | 需要导出 | 原生支持 |
| **版本控制** | 分支 | 完整 Git |
| **协作** | 实时协作 | 传统 Git 协作 |
| **可视化** | 内置 | 需要额外工作 |
| **适用场景** | 探索性分析 | 生产代码 |

## 使用场景

### 1. 数据探索

- **快速原型**：快速构建数据原型
- **临时分析**：临时数据分析
- **可视化**：数据可视化

### 2. 数据转换

- **数据清洗**：清洗数据
- **数据转换**：转换数据格式
- **特征工程**：创建机器学习特征

### 3. 机器学习

- **模型训练**：训练机器学习模型
- **模型评估**：评估模型性能
- **模型部署**：准备部署

### 4. 协作分析

- **团队协作**：团队共享分析
- **知识共享**：共享分析逻辑
- **代码复用**：复用代码

## 最佳实践

### 1. 性能优化

- **缓存数据**：缓存中间结果
- **优化 Spark**：优化 Spark 配置
- **使用适当的数据类型**：选择合适的数据类型

### 2. 代码组织

- **模块化**：模块化代码
- **使用模板**：使用模板复用
- **全局代码**：在全局代码中共享函数

### 3. 协作

- **分支策略**：使用分支隔离变更
- **文档记录**：记录分析步骤
- **代码审查**：审查代码变更

### 4. 生产化

- **导出代码**：导出到 Code Repository
- **测试**：充分测试代码
- **文档**：编写文档

## 键盘快捷键

### 常用快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+Enter` | 运行当前节点 |
| `Shift+Enter` | 运行当前节点并移到下一个 |
| `Ctrl+S` | 保存 |
| `Ctrl+Z` | 撤销 |
| `Ctrl+Y` | 重做 |

## 可用字体

Code Workbook 支持多种字体用于可视化。

## 限制

### 当前限制

- **遗留状态**：不再进行新开发
- **支持**：完全支持仍然可用
- **推荐替代**：建议使用其他工具

## 迁移指南

### 迁移到 Code Repositories

1. **导出代码**：从 Code Workbook 导出代码
2. **创建 Repository**：创建 Code Repository
3. **导入代码**：导入导出的代码
4. **配置环境**：配置执行环境
5. **测试**：充分测试代码

### 迁移到 Code Workspaces

1. **创建 Workspace**：创建 Code Workspace
2. **迁移代码**：迁移代码到 Workspace
3. **配置环境**：配置开发环境
4. **测试**：充分测试代码

## 相关文档

- [Getting started](https://palantir.com/docs/foundry/code-workbook/getting-started/) - 入门指南
- [Core concepts](https://palantir.com/docs/foundry/code-workbook/core-concepts/) - 核心概念
- [Keyboard shortcuts](https://palantir.com/docs/foundry/code-workbook/keyboard-shortcuts/) - 键盘快捷键
- [FAQ](https://palantir.com/docs/foundry/code-workbook/faq/) - 常见问题
- [Workbooks](https://palantir.com/docs/foundry/code-workbook/workbooks/) - 工作簿
- [Transforms](https://palantir.com/docs/foundry/code-workbook/transforms/) - 转换
- [Templates](https://palantir.com/docs/foundry/code-workbook/templates/) - 模板
- [Environment](https://palantir.com/docs/foundry/code-workbook/environment/) - 环境
- [Branching](https://palantir.com/docs/foundry/code-workbook/branching/) - 分支

---

*本文档基于 Palantir Foundry 官方文档整理*
