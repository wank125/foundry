# Palantir Foundry 模型连接与开发 - 官方案例与操作指南

> 更新时间：2025-12-28

## 目录

- [官方教程资源](#官方教程资源)
- [模块架构概述](#模块架构概述)
- [AIP Logic - 无代码 AI 函数构建](#aip-logic---无代码-ai-函数构建)
- [Model Catalog - 模型发现与管理](#model-catalog---模型发现与管理)
- [AIP Agent Studio - AI 代理构建](#aip-agent-studio---ai-代理构建)
- [Modeling Objectives - ML 模型生命周期](#modeling-objectives---ml-模型生命周期)
- [Code Workspaces - 交互式开发环境](#code-workspaces---交互式开发环境)
- [最佳实践](#最佳实践)
- [故障排除](#故障排除)

---

## 官方教程资源

### Palantir Learn 课程

| 课程名称 | 时长 | 描述 | 链接 |
|---------|------|------|------|
| AIP Logic Getting Started | 30-45 分钟 | AIP Logic 基础入门，学习构建 LLM 驱动的函数 | [查看](https://palantir.com/docs/foundry/logic/getting-started/) |
| Model Catalog Overview | 15-20 分钟 | 模型目录功能介绍和模型选择指南 | [查看](https://palantir.com/docs/foundry/model-catalog/overview/) |
| AIP Agent Studio Tutorial | 45-60 分钟 | 构建和部署交互式 AI 代理 | [查看](https://palantir.com/docs/foundry/agent-studio/getting-started/) |
| Modeling Objectives | 30-45 分钟 | ML 模型全生命周期管理 | [查看](https://palantir.com/docs/foundry/model-integration/objectives/) |
| Code Workspaces Intro | 20-30 分钟 | JupyterLab/RStudio 集成开发环境 | [查看](https://palantir.com/docs/foundry/code-workspaces/getting-started/) |

### 视频教程

| 视频名称 | 平台 | 链接 |
|---------|------|------|
| Introduction to AIP Agents | YouTube | [观看](https://www.youtube.com/watch?v=sr1oRPGKlTQ) |
| Intro to Code Workspaces | YouTube | [观看](https://www.youtube.com/watch?v=DHLP00_PhQY) |
| Tool Use in AIP Logic | YouTube | [观看](https://www.youtube.com/watch?v=mCOvUImg2U8) |

---

## 模块架构概述

### 组件关系图

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    模型连接与开发模块 (Module 02)                          │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐              │
│  │  Model       │───▶│  AIP Logic   │───▶│  AIP Agent   │              │
│  │  Catalog     │    │              │    │  Studio      │              │
│  └──────────────┘    └──────────────┘    └──────────────┘              │
│         │                    │                     │                    │
│         ▼                    ▼                     ▼                    │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐              │
│  │  Modeling    │    │   Code       │    │   Workshop   │              │
│  │  Objectives  │    │   Workspaces │    │   Integr.    │              │
│  └──────────────┘    └──────────────┘    └──────────────┘              │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│  核心功能：                                                               │
│  • LLM 集成 (200+ 模型)  • AI 代理构建  • ML 模型管理  • 开发环境         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 功能分类

| 功能类别 | 组件 | 用途 |
|---------|------|------|
| **LLM 集成** | Model Catalog, AIP Logic | 发现和使用大语言模型 |
| **AI 代理** | AIP Agent Studio | 构建交互式 AI 助手 |
| **ML 模型** | Modeling Objectives, Code Workspaces | 传统机器学习模型管理 |
| **开发环境** | Code Workspaces, Code Repositories | JupyterLab/RStudio 集成 |

---

## AIP Logic - 无代码 AI 函数构建

### 核心概念

AIP Logic 是 Foundry 的无代码开发环境，用于构建由 LLM 驱动的函数。通过拖拽式块（Blocks）组合，您可以创建强大的 AI 逻辑而无需编写代码。

### 访问 AIP Logic

**方式一：从导航栏访问**
1. 点击工作区导航栏中的 "AIP Logic"

**方式二：从 Files 创建**
1. 打开 Files 应用
2. 选择 `+New` → `AIP Logic`
3. Logic 文件必须保存在项目文件夹中

![创建 AIP Logic](https://www.palantir.com/docs/resources/foundry/logic/create-new-aip-logic.png)

### 应用界面

AIP Logic 界面由三个主要组件组成：

```
┌─────────────────────────────────────────────────────────────────────┐
│ AIP Logic 界面布局                                                     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  (1) 输入/块/输出配置 │ (2) Debugger │ (3) Run 面板                    │
│  ┌──────────────┐   ┌──────────┐  ┌──────────────┐                  │
│  │ Inputs       │   │ Chain of │  │ Run          │                  │
│  │              │   │ Thought  │  │              │                  │
│  │ ┌─────────┐  │   │          │  │ Recent runs  │                  │
│  │ │ Blocks  │  │   │ Prompts  │  │ Unit tests   │                  │
│  │ └─────────┘  │   │ Tools    │  │ History      │                  │
│  │              │   │          │  │              │                  │
│  │ Outputs      │   │ Steps    │  │              │                  │
│  └──────────────┘   └──────────┘  └──────────────┘                  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

![AIP Logic 界面概览](https://www.palantir.com/docs/resources/foundry/logic/logic-app-overview.png)

### 典型工作流程

1. **配置** - 在左侧面板配置输入(A)、块(B)和输出(C)
2. **运行** - 使用 Run 面板生成示例输出
3. **调试** - 在 Debugger 中查看 LLM 的思维链(CoT)
4. **测试** - 创建单元测试进行性能评估
5. **发布** - 发布 Logic 函数供其他应用使用

### 配置输入、块和输出

#### Inputs（输入）

支持的输入类型：

| 类型 | 说明 |
|------|------|
| array, boolean, date, double, float | 基础数据类型 |
| integer, long, short | 整数类型 |
| string | 字符串 |
| media reference | 媒体引用 |
| model, object | 对象类型 |
| object list, object set | 对象集合 |
| struct | 结构体 |
| timestamp | 时间戳 |

#### Blocks（块）类型

| 块类型 | 说明 | 图片 |
|--------|------|------|
| **Use LLM** | 使用 LLM 进行自然语言处理 | ![LLM Block](https://www.palantir.com/docs/resources/foundry/logic/block-use-llm-prompt.png) |
| **Apply action** | 确定性地调用操作 | ![Action Block](https://www.palantir.com/docs/resources/foundry/logic/action-block.png) |
| **Execute function** | 调用其他现有函数 | ![Execute Block](https://www.palantir.com/docs/resources/foundry/logic/execute-one.png) |
| **Conditional** | 条件分支逻辑 | ![Conditional](https://www.palantir.com/docs/resources/foundry/logic/conditional-block.png) |
| **Loop** | 迭代集合元素 | ![Loop](https://www.palantir.com/docs/resources/foundry/logic/loop-block.png) |
| **Create variable** | 创建变量 | ![Variable](https://www.palantir.com/docs/resources/foundry/logic/block-create-variable.png) |

#### Outputs（输出）

| 输出类型 | 说明 |
|---------|------|
| **Block output** | 块之间传递的中间输出 |
| **Logic function output** | Logic 函数的最终返回值 |

### Use LLM 块详解

Use LLM 块是 AIP Logic 的核心，包含三个部分：

#### 1. Prompts（提示词）

提示词是给 LLM 的自然语言指令。推荐的提示词结构：

```
┌────────────────────────────────────────────────────────────────┐
│ 提示词结构示例                                                   │
├────────────────────────────────────────────────────────────────┤
│ 1. 任务概述（Task Overview）                                     │
│    "You are my complaint helper agent."                         │
│                                                                 │
│ 2. 具体任务（Specific Task）                                     │
│    "Find other emails that describe similar events..."          │
│                                                                 │
│ 3. 数据来源（Data Sources）                                      │
│    "Look only at the email body."                               │
│                                                                 │
│ 4. 输出格式（Output Format）                                     │
│    "Return your one solution recommendation..."                │
└────────────────────────────────────────────────────────────────┘
```

![提示词示例](https://www.palantir.com/docs/resources/foundry/logic/block-use-llm-prompt.png)

#### 2. Tools（工具）

AIP Logic 提供的四类工具：

| 工具 | 说明 | 图片 |
|------|------|------|
| **Apply actions** | 使用 Actions 编辑 Ontology | ![Apply Actions](https://www.palantir.com/docs/resources/foundry/logic/apply-actions-example.png) |
| **Call function** | 调用现有函数 | ![Call Function](https://www.palantir.com/docs/resources/foundry/logic/call-function-example.png) |
| **Query objects** | 查询对象数据 | ![Query Objects](https://www.palantir.com/docs/resources/foundry/logic/query-objects-example.png) |
| **Calculator** | 执行数学计算 | - |

![工具选择下拉菜单](https://www.palantir.com/docs/resources/foundry/logic/aip-logic-tools-dropdown.png)

#### 3. Output（输出）

LLM 块可以返回：
- 原始值（字符串、数字等）
- 对象
- Ontology 编辑

### Debugger（调试器）

运行 Logic 函数后，Debugger 会显示 LLM 的思维链(CoT)：

![Debugger 视图](https://www.palantir.com/docs/resources/foundry/logic/debugger-screen.png)

Debugger 功能：
- 展开/折叠块卡片
- 清除工具调用
- 查看生成的提示词
- 审查 LLM 的推理步骤

### Run 面板

![Run 视图](https://www.palantir.com/docs/resources/foundry/logic/run-view.png)

Run 面板功能：
- 运行和评估 Logic 函数
- 查看最近的运行记录
- 创建和管理单元测试

### 单元测试

点击单元测试图标保存输入版本：

![单元测试示例](https://www.palantir.com/docs/resources/foundry/logic/unit-tests-example.png)

### 使用 Logic 函数

#### 方式一：通过 Action 调用

1. 创建由 Logic 函数支持的操作类型
2. 从 Workshop 调用该操作

![创建 Action Type](https://www.palantir.com/docs/resources/foundry/logic/create-a-new-action-type.png)

#### 方式二：在 Workshop 中使用 Markdown 小部件

Logic 函数的输出类型必须为字符串：

![Markdown 小部件](https://www.palantir.com/docs/resources/foundry/logic/logic-function-back-markdown-widget.png)

#### 方式三：命令行调用

在 Uses 标签页复制 curl 请求：

![命令行请求](https://www.palantir.com/docs/resources/foundry/logic/command-line-request.png)

### 使用 Logic 函数编辑 Ontology

要使 Logic 函数能够编辑 Ontology：

1. **设置 Apply actions 工具** - 在 Use LLM 块中配置

![Apply Actions 工具](https://www.palantir.com/docs/resources/foundry/logic/apply-actions-example-flight.png)

2. **发布 Logic 函数** - 选择 Publish 选项

3. **创建支持的 Action** - 将 Logic 函数包装成 Action

![配置 Action Type](https://www.palantir.com/docs/resources/foundry/logic/logic-function-configure-action-type.png)

4. **在 Workshop 中使用**

![Workshop 配置](https://www.palantir.com/docs/resources/foundry/logic/use-action-in-workshop.png)

### 版本比较

在版本历史标签页比较两个版本的差异：

![Logic 比较](https://www.palantir.com/docs/resources/foundry/logic/compare-view.png)

---

## Model Catalog - 模型发现与管理

### 核心概念

Model Catalog 是 Foundry 中的 AIP 应用，用于发现和了解所有 Palantir 提供的模型。

### 主要功能

| 功能 | 描述 |
|------|------|
| **模型发现** | 查看所有可用的 LLM 模型 |
| **模型选择** | 根据用例选择合适的模型 |
| **快速开始** | 使用模板启动工作流 |
| **沙盒测试** | 在 Playground 中测试模型 |

### Model Catalog 主页

![Model Catalog 主页](https://www.palantir.com/docs/resources/foundry/model-catalog/model-catalog-home.png)

### 模型筛选

#### 按生命周期状态筛选

| 状态 | 说明 |
|------|------|
| **Experimental** | 实验性模型，API 可能变化，适合探索测试 |
| **Stable** | 稳定版本，适合生产环境 |
| **Sunset** | 即将弃用，支持现有工作流 |
| **Deprecated** | 已弃用，无法支持工作流 |

#### 按模型类型筛选

| 类型 | 说明 | 示例 |
|------|------|------|
| **Completion** | 文本生成和补全 | GPT-4 Turbo, Mixtral 8x7B |
| **Embedding** | 向量嵌入，语义搜索 | text-embedding-ada-002 |
| **Vision** | 视觉分析 | GPT-4 Vision, Gemini Pro Vision |

#### 按模型创建者筛选

| 创建者 | 说明 |
|--------|------|
| OpenAI | GPT 系列 |
| Anthropic | Claude 系列 |
| Google | Gemini 系列 |
| Mixtral AI | Mixtral 系列 |
| Palantir | Llama, Mixtral 托管 |

### 模型实体页面

每个模型都有实体页面，包含三个部分：

![模型实体页面](https://www.palantir.com/docs/resources/foundry/model-catalog/model-catalog-model.png)

| 部分 | 功能 |
|------|------|
| **Playground** | 测试不同模型的界面 |
| **How to use it** | 创建预填充资源的快速开始 |
| **Model description** | 模型描述、上下文窗口、训练数据截止日期等 |

### 模型比较页面

![模型比较视图](https://www.palantir.com/docs/resources/foundry/model-catalog/model-catalog-comparison.png)

模型比较页面允许您：
- 选择两个 LLM 进行比较
- 在相同的完成或视觉任务上测试
- 做出明智的模型选择决策

### 支持的 LLM

Model Catalog 包含以下常用模型：

| 模型 | 类型 | 创建者 | 状态 |
|------|------|--------|------|
| GPT-4 Turbo | Completion | OpenAI | Stable |
| GPT-4 Vision | Vision | OpenAI | Stable |
| Claude 3 Opus | Completion | Anthropic | Stable |
| Gemini Pro | Completion | Google | Stable |
| Llama 2 70B | Completion | Meta/Palantir | Stable |
| Mixtral 8x7B | Completion | Mixtral AI | Stable |
| text-embedding-ada-002 | Embedding | OpenAI | Stable |

---

## AIP Agent Studio - AI 代理构建

### 核心概念

AIP Agent Studio 允许用户构建交互式助手（AIP Agents），这些助手配备企业特定信息和工具，可以在平台内外部署。

### 4 层代理框架

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    AIP Agent 4 层框架                                     │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  Layer 1: Foundation (基础层)                                    │   │
│  │  • LLM 选择        • 基础配置        • 安全设置                  │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              ▲                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  Layer 2: Knowledge (知识层)                                     │   │
│  │  • Ontology 数据  • 文档资源      • 企业知识库                   │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              ▲                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  Layer 3: Tools (工具层)                                         │   │
│  │  • Actions        • Functions      • API 集成                   │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              ▲                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  Layer 4: Guardrails (防护层)                                    │   │
│  │  • 安全策略        • 权限控制      • 审计日志                    │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 访问 AIP Agent Studio

1. 从平台导航栏选择 "AIP Agent Studio"
2. 或使用快捷键 `CMD + J` / `CTRL + J` 搜索

### 创建基本 Agent 步骤

#### 步骤 1：创建新 Agent

1. 在 AIP Agent Studio 中点击 "Create new agent"
2. 选择基础配置
3. 命名您的 Agent

#### 步骤 2：配置知识层

| 配置项 | 说明 |
|--------|------|
| **对象类型** | 选择 Agent 可以访问的 Ontology 对象 |
| **文档资源** | 添加参考文档和知识库 |
| **数据集** | 指定可查询的数据源 |

#### 步骤 3：配置工具层

| 工具类型 | 配置方法 |
|---------|---------|
| **Actions** | 选择 Agent 可以调用的操作 |
| **Functions** | 添加 Logic 或代码函数 |
| **APIs** | 配置外部 API 集成 |

#### 步骤 4：配置防护层

| 安全设置 | 说明 |
|---------|------|
| **权限范围** | 限制 Agent 访问的数据 |
| **操作限制** | 定义 Agent 可以执行的操作 |
| **审计日志** | 启用活动跟踪 |

### 部署 Agent

#### 平台内部部署

1. 发布 Agent 到 Foundry
2. 在 Workshop 中集成
3. 配置用户访问权限

#### 平台外部部署（OSDK）

1. 使用 OSDK 框架
2. 配置 OAuth 认证
3. 部署到外部应用

### 监控 Agent 生产运行

| 监控指标 | 说明 |
|---------|------|
| **请求量** | Agent 调用次数 |
| **响应时间** | 平均响应延迟 |
| **成功率** | 成功完成请求的百分比 |
| **工具使用** | 各工具的调用频率 |

---

## Modeling Objectives - ML 模型生命周期

### 核心概念

Modeling Objective 是一个项目上下文，包含相关数据源、元数据和模型，都围绕特定的运营问题集中管理。

### 概念关系图

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    Modeling Objectives 工作流                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────────┐      ┌──────────────┐      ┌──────────────┐          │
│  │   Objective  │─────▶│  Submission  │─────▶│   Release    │          │
│  │   (问题定义)  │      │   (模型提交)  │      │   (版本发布)  │          │
│  └──────────────┘      └──────────────┘      └──────────────┘          │
│         │                      │                      │                 │
│         ▼                      ▼                      ▼                 │
│  ┌──────────────┐      ┌──────────────┐      ┌──────────────┐          │
│  │    Metrics   │      │  Deployment  │      │  Production  │          │
│  │   (评估指标)  │      │   (部署配置)  │      │  (生产运行)   │          │
│  └──────────────┘      └──────────────┘      └──────────────┘          │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

![Modeling Objectives 概念流程](https://www.palantir.com/docs/resources/foundry/model-integration/concepts_concept-flow1.png)

### 关键概念

| 概念 | 说明 |
|------|------|
| **Objective** | 建模问题的定义接口 |
| **Submission** | 提交的模型版本副本，类似 Pull Request |
| **Release** | 版本化、打包的生产就绪资产 |
| **Deployment** | 将模型交付给消费者的 CI/CD 层 |
| **Metrics** | 模型评估指标定义 |

### 部署类型

#### Batch Deployments（批量部署）

| 特性 | 说明 |
|------|------|
| **用途** | 大规模生产管道 |
| **计算** | 分布式计算 |
| **输入/输出** | 从输入数据集读取，写入输出数据集 |
| **管理** | 通过构建调度管理 |

#### Live Deployments（实时部署）

| 特性 | 说明 |
|------|------|
| **用途** | 低延迟或交互式设置 |
| **接口** | 无服务器 REST API 端点 |
| **可用性** | 高可用，支持零停机更新 |
| **权限** | 独立权限控制 |

![部署概念](https://www.palantir.com/docs/resources/foundry/model-integration/concepts_concept-deployments.png)

### Metrics（指标）

![Metrics 概念流程](https://www.palantir.com/docs/resources/foundry/model-integration/concept-metric-flow.png)

指标功能：
- 在评估数据集上生成和跟踪指标
- 支持逻辑子集评估
- 在模型预览中可见
- 在评估仪表板中可比较

### Metadata（元数据）

Objective 的可配置元数据支持：
- 管理工作流
- 协作工作流
- 模型比较
- 自定义字段收集

---

## Code Workspaces - 交互式开发环境

### 核心概念

Code Workspaces 将 JupyterLab、RStudio Workbench 和 VS Code 带入 Palantir Foundry，使用户能够使用首选工具提升生产力。

### 支持的 IDE

| IDE | 主要用途 | 语言支持 |
|-----|---------|---------|
| **JupyterLab** | 数据科学、机器学习 | Python |
| **RStudio Workbench** | 统计分析 | R |
| **VS Code** | 通用开发 | 多语言 |

### 关键特性

| 特性 | 说明 |
|------|------|
| **安全性** | 基于 Foundry 安全模型，细粒度访问控制 |
| **自定义环境** | 定义自定义环境配置文件 |
| **Git 工作流** | 支持分支、合并、提交历史 |
| **应用支持** | Dash、Streamlit、Shiny |
| **模型集成** | 创建和跟踪模型资产 |
| **Transform 集成** | 开发数据转换管道 |

### 何时使用 Code Workspaces

| 使用场景 | 推荐工具 |
|---------|---------|
| 点按式低代码数据分析 | Contour |
| 大规模数据管道 | Pipeline Builder, Code Repositories |
| 流数据处理 | Foundry Streaming |
| **机器学习模型** | **Code Workspaces** ✅ |
| **JupyterLab/RStudio 熟悉用户** | **Code Workspaces** ✅ |

### 与 Foundry 生态集成

```
┌─────────────────────────────────────────────────────────────────────────┐
│                 Code Workspaces 集成生态                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐              │
│  │ JupyterLab   │    │  Ontology    │    │  Modeling    │              │
│  │              │◀──▶│  Data Access │◀──▶│  Objectives  │              │
│  └──────────────┘    └──────────────┘    └──────────────┘              │
│         │                    │                     │                    │
│         ▼                    ▼                     ▼                    │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐              │
│  │   Transforms │    │  Git Version │    │   Apps       │              │
│  │   Publish    │    │   Control    │    │   Dash/      │              │
│  │              │    │              │    │   Streamlit  │              │
│  └──────────────┘    └──────────────┘    └──────────────┘              │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 设置工作区

#### 步骤 1：创建工作区

1. 在 Code Workspaces 中点击 "New workspace"
2. 选择 IDE 类型（JupyterLab 或 RStudio）
3. 选择环境配置文件
4. 设置计算资源

#### 步骤 2：配置环境

| 配置项 | 选项 |
|--------|------|
| **环境配置文件** | Python 3.x, R 4.x, 自定义 |
| **计算资源** | CPU, 内存, GPU |
| **存储** | 临时存储, 持久化存储 |

#### 步骤 3：连接数据

```python
# 在 JupyterLab 中读取 Foundry 数据集
from foundry import FoundryClient

client = FoundryClient()
df = client.get_dataset('ri.foundry.main.dataset.example')
```

```r
# 在 RStudio 中读取 Foundry 数据集
library(foundry)
df <- foundry_read_dataset("ri.foundry.main.dataset.example")
```

### 发布模型

从 Code Workspaces 发布模型到 Modeling Objectives：

1. 训练模型
2. 创建模型资产
3. 提交到 Objective
4. 配置评估指标

### 发布 Transforms

将代码转换为数据管道：

1. 在 Code Workspaces 中编写转换逻辑
2. 发布为 Transform
3. 集成到 Pipeline Builder
4. 配置构建调度

---

## 最佳实践

### AIP Logic 最佳实践

| 实践 | 说明 |
|------|------|
| **提示词结构** | 从任务概述开始，然后是数据，最后是输出格式 |
| **工具使用** | 只提供 LLM 需要的工具，减少 token 使用 |
| **单元测试** | 为关键 Logic 函数创建全面的测试套件 |
| **版本控制** | 使用比较视图跟踪 Logic 函数的变化 |
| **权限最小化** | Logic 函数只访问必需的数据和操作 |

### Model Catalog 最佳实践

| 实践 | 说明 |
|------|------|
| **模型选择** | 在 Stable 模型用于生产，Experimental 用于测试 |
| **比较测试** | 使用比较页面评估不同模型的性能 |
| **成本优化** | 根据任务复杂度选择合适的模型 |
| **区域可用性** | 检查模型在您所在区域的可用性 |

### AIP Agent Studio 最佳实践

| 实践 | 说明 |
|------|------|
| **分层设计** | 按照 4 层框架系统化构建 Agent |
| **知识管理** | 定期更新 Agent 的知识库和文档 |
| **工具限制** | 只配置必要的工具以降低风险 |
| **监控告警** | 设置生产监控和异常告警 |
| **渐进部署** | 先在测试环境验证，再部署生产 |

### Modeling Objectives 最佳实践

| 实践 | 说明 |
|------|------|
| **Objective 定义** | 清晰定义建模问题和成功指标 |
| **版本管理** | 使用 Release 系统保护生产部署 |
| **自动化 CI/CD** | 配置部署自动获取最新标记的 Release |
| **指标跟踪** | 系统化收集和比较模型指标 |

### Code Workspaces 最佳实践

| 实践 | 说明 |
|------|------|
| **资源管理** | 根据工作负载调整计算资源 |
| **版本控制** | 使用 Git 分支管理实验 |
| **环境一致性** | 使用标准环境配置文件 |
| **数据权限** | 遵循 Foundry 访问控制原则 |
| **定期保存** | 频繁提交代码避免丢失工作 |

---

## 故障排除

### AIP Logic 常见问题

| 问题 | 解决方案 |
|------|---------|
| **LLM 响应不符合预期** | 在 Debugger 中检查提示词和工具调用，优化提示词结构 |
| **Token 限制错误** | 减少提供的数据量，优化查询 |
| **工具调用失败** | 检查工具权限配置，验证函数参数 |
| **Logic 函数无法编辑 Ontology** | 确保通过 Action 调用，检查 Apply actions 工具配置 |

### Model Catalog 常见问题

| 问题 | 解决方案 |
|------|---------|
| **模型不可用** | 联系平台管理员启用模型，检查区域可用性 |
| **性能不佳** | 尝试使用模型比较页面测试其他模型 |
| **API 变化** | 关注 Experimental 模型的更新通知 |

### AIP Agent Studio 常见问题

| 问题 | 解决方案 |
|------|---------|
| **Agent 响应缓慢** | 检查知识库大小，优化工具配置 |
| **权限错误** | 验证 Agent 的访问权限配置 |
| **部署失败** | 检查 OSDK 配置和 OAuth 设置 |

### Modeling Objectives 常见问题

| 问题 | 解决方案 |
|------|---------|
| **部署未更新** | 检查 Release 环境标签，确认自动更新配置 |
| **指标计算失败** | 验证评估数据集权限和格式 |
| **Batch 部署超时** | 增加计算资源或优化模型代码 |

### Code Workspaces 常见问题

| 问题 | 解决方案 |
|------|---------|
| **工作区无法启动** | 检查计算资源配额，联系管理员 |
| **包安装失败** | 查看支持的包列表，使用自定义环境 |
| **数据访问被拒** | 验证 Foundry 数据集权限 |
| **Git 操作失败** | 检查 Code Repositories 配置和分支权限 |

---

## 相关文档

- [AIP Logic 官方文档](https://palantir.com/docs/foundry/logic/overview/)
- [Model Catalog 官方文档](https://palantir.com/docs/foundry/model-catalog/overview/)
- [AIP Agent Studio 官方文档](https://palantir.com/docs/foundry/agent-studio/overview/)
- [Modeling Objectives 官方文档](https://palantir.com/docs/foundry/model-integration/objectives/)
- [Code Workspaces 官方文档](https://palantir.com/docs/foundry/code-workspaces/overview/)
- [Foundry Functions 文档](https://palantir.com/docs/foundry/functions/)
- [Ontology Manager 指南](03-本体构建---官方案例与操作指南.md)
- [数据连接与集成指南](01-数据连接与集成---官方案例与操作指南.md)

---

*本文档基于 Palantir Foundry 官方文档整理*
